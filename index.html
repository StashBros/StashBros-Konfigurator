<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StashBros Produkt-Konfigurator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9f9f9;
    }

    header {
      background-color: #00796b;
      color: white;
      padding: 20px;
      text-align: center;
    }

    main {
      padding: 20px;
    }

    section {
      margin-bottom: 30px;
    }

    form {
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    table th, table td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
    }

    table th {
      background-color: #00796b;
      color: white;
    }

    @media screen and (max-width: 600px) {
      table, th, td {
        display: block;
      }

      th {
        background-color: #00796b;
        color: white;
      }

      td {
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>StashBros Produkt-Konfigurator</h1>
  </header>
  <main>
    <section>
      <h2>Verbrauchsberechnung</h2>
      <form id="calculator-form">
        <label for="members">Anzahl der Mitglieder:</label>
        <input type="number" id="members" name="members" min="1" required>
        <button type="submit">Berechnen</button>
      </form>
    </section>

    <section>
      <h2>Produktempfehlungen</h2>
      <div id="recommendations">
        <table>
          <thead>
            <tr>
              <th>Produktname</th>
              <th>Fassungsgrößen (L)</th>
              <th>Anzahl</th>
              <th>Einzelpreise (€)</th>
              <th>Gesamtkosten (€)</th>
            </tr>
          </thead>
          <tbody id="recommendation-table"></tbody>
        </table>
      </div>
    </section>

    <section>
      <h2>Abo-Optionen</h2>
      <div id="subscriptions">
        <table>
          <thead>
            <tr>
              <th>Abo-Größe</th>
              <th>Rabatt (%)</th>
              <th>Rabattierte Gesamtkosten (€)</th>
              <th>Kosten pro Gramm (€)</th>
              <th>Kosten pro Pflanze (€)</th>
              <th>Monatliche Kosten (€)</th>
            </tr>
          </thead>
          <tbody id="subscription-table"></tbody>
        </table>
        <p>* Durchschnittlicher Ertrag pro Pflanze: 66,96 g.</p>
      </div>
    </section>
  </main>
  <script>
    document.getElementById('calculator-form').addEventListener('submit', function (e) {
      e.preventDefault();

      const members = parseInt(document.getElementById('members').value);
      const plants = members / 500;

      const productData = [
        { name: 'Coco', base: 168, sizes: [20, 10, 5, 1, 0.5], prices: [46.3, 26.4, 17.05, 6.15, 5] },
        { name: 'TNT Complex', base: 61.6, sizes: [20, 10, 5, 1, 0.5], prices: [51.55, 30, 18.45, 6.9, 5.15] },
        { name: 'Wurzel Complex', base: 61.6, sizes: [5, 1], prices: [56.6, 12] },
        { name: 'PowerZyme', base: 100.8, sizes: [5, 1, 0.5], prices: [33.75, 8.5, 4.5] },
        { name: 'SuperVit', base: 0.62, sizes: [0.5, 0.05], prices: [92.1, 10] },
        { name: 'PK 13/14', base: 100.8, sizes: [20, 10, 5, 1, 0.5], prices: [86.65, 49.7, 28.45, 7.5, 4] },
      ];

      const recommendations = [];
      let totalCost = 0;

      productData.forEach((product) => {
        let remaining = product.base * plants;
        const productRecommendation = { name: product.name, details: [] };

        product.sizes.forEach((size, index) => {
          if (remaining >= size) {
            const quantity = Math.floor(remaining / size);
            remaining %= size;

            productRecommendation.details.push({
              size,
              quantity,
              price: product.prices[index],
              total: quantity * product.prices[index],
            });

            totalCost += quantity * product.prices[index];
          }
        });

        recommendations.push(productRecommendation);
      });

      displayRecommendations(recommendations);
      calculateSubscriptions(totalCost, plants);
    });

    function displayRecommendations(recommendations) {
      const tableBody = document.getElementById('recommendation-table');
      tableBody.innerHTML = '';

      recommendations.forEach((product) => {
        product.details.forEach((detail, index) => {
          const row = document.createElement('tr');

          if (index === 0) {
            const nameCell = document.createElement('td');
            nameCell.rowSpan = product.details.length;
            nameCell.textContent = product.name;
            row.appendChild(nameCell);
          }

          row.innerHTML += `
            <td>${detail.size} L</td>
            <td>${detail.quantity}</td>
            <td>${detail.price.toFixed(2)} €</td>
            <td>${detail.total.toFixed(2)} €</td>
          `;

          tableBody.appendChild(row);
        });
      });
    }

    function calculateSubscriptions(totalCost, plants) {
      const subscriptions = [
        { size: 'Small', weeks: 10, discount: 1.96 },
        { size: 'Medium', weeks: 20, discount: 6.67 },
        { size: 'Large', weeks: 40, discount: 13.82 },
      ];

      const tableBody = document.getElementById('subscription-table');
      tableBody.innerHTML = '';

      subscriptions.forEach((sub) => {
        const discountedCost = totalCost * (1 - sub.discount / 100);
        const costPerPlant = discountedCost / plants;
        const costPerGram = discountedCost / (plants * 66.96);
        const monthlyCost = discountedCost / (sub.weeks / 10);

        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${sub.size}</td>
          <td>${sub.discount.toFixed(2)}%</td>
          <td>${discountedCost.toFixed(2)} €</td>
          <td>${costPerGram.toFixed(2)} €</td>
          <td>${costPerPlant.toFixed(2)} €</td>
          <td>${monthlyCost.toFixed(2)} €</td>
        `;

        tableBody.appendChild(row);
      });
    }
  </script>
</body>
</html>
